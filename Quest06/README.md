# Quest 06. 인터넷의 이해

## Introduction

- 이번 퀘스트에서는 인터넷이 어떻게 동작하며, 서버와 클라이언트, 웹 브라우저 등의 역할은 무엇인지 알아보겠습니다.

## Topics

- 서버와 클라이언트, 그리고 웹 브라우저
- 인터넷을 구성하는 여러 가지 프로토콜
  - IP
  - TCP
  - HTTP
- DNS

## Resources

- [OSI 모형](https://ko.wikipedia.org/wiki/OSI_%EB%AA%A8%ED%98%95)
- [IP](https://ko.wikipedia.org/wiki/%EC%9D%B8%ED%84%B0%EB%84%B7_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)
  - [Online service Traceroute](http://ping.eu/traceroute/)
- [TCP](https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_%EC%A0%9C%EC%96%B4_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)
  - [Wireshark](https://www.wireshark.org/download.html)
- [HTTP](https://ko.wikipedia.org/wiki/HTTP)
  - Chrome developer tool, Network tab
- [DNS](https://ko.wikipedia.org/wiki/%EB%8F%84%EB%A9%94%EC%9D%B8_%EB%84%A4%EC%9E%84_%EC%8B%9C%EC%8A%A4%ED%85%9C)
  - [Web-based Dig](http://networking.ringofsaturn.com/Tools/dig.php)

## Checklist

- 인터넷은 어떻게 동작하나요? Internet Protocol Suite의 레이어 모델에 입각하여 설명해 보세요.
  인터넷은 전 세계의 컴퓨터 네트워크가 연결된 거대한 네트워크이다. 이러한 컴퓨터 네트워크들은 다양한 크기와 기능을 가지고 있으며, 각각의 네트워크는 물리적인 매체를 사용하여 서로 연결되어 있다.
  인터넷을 구성하는 네트워크들이 서로 통신하기 위해서는, 데이터를 전송하기 위한 공통적인 프로토콜이 필요하다. 이 때 사용되는 프로토콜의 모음을 Internet Protocol Suite 또는 TCP/IP Suite라고 부른다. 이 프로토콜의 레이어 모델은 다음과 같다.

  1. Physical Layer (물리 계층)
     물리 계층은 데이터를 전송하기 위한 물리적인 매체를 다룬다. 이 계층에서는 데이터를 전기 신호로 변환하여 전송할 수 있다. 이 계층의 대표적인 기술로는 Ethernet, Wi-Fi, Bluetooth 등이 있다.

  2. Data Link Layer (데이터 링크 계층)
     데이터 링크 계층은 물리 계층으로부터 받은 데이터를 논리적인 프레임으로 나누고, 오류 검출 및 수정을 수행한다. 이 계층에서는 물리 주소(MAC 주소)를 사용하여 노드들을 식별한다. 대표적인 프로토콜로는 Ethernet, Wi-Fi, Bluetooth 등이 있다.

  3. Network Layer (네트워크 계층)
     네트워크 계층은 데이터를 전송하기 위한 경로를 결정하고, 패킷을 전송한다. 이 계층에서는 논리적인 주소(IP 주소)를 사용하여 노드들을 식별한다. 라우터를 사용하여 여러 개의 네트워크를 연결할 수 있다. 대표적인 프로토콜로는 IP(Internet Protocol)가 있다.

  4. Transport Layer (전송 계층)
     전송 계층은 양 끝단의 프로세스 간에 데이터를 신뢰성 있게 전송하기 위한 계층이다. 이 계층에서는 포트 번호를 사용하여 프로세스를 식별한다. 대표적인 프로토콜로는 TCP(Transmission Control Protocol)와 UDP(User Datagram Protocol)가 있다.

  - 근거리에서 서로 떨어진 두 전자기기가 유선/무선으로 서로 통신하는 프로토콜은 어떻게 동작할까요?
    근거리에서 서로 통신하는 두 전자기기가 유선 또는 무선으로 통신하기 위해서는 해당 통신 프로토콜을 사용해야 한다. 일반적으로 유선 통신에는 Ethernet, USB, HDMI 등의 프로토콜이 사용되고, 무선 통신에는 Wi-Fi, Bluetooth, NFC 등의 프로토콜이 사용된다.
    이러한 프로토콜은 각각의 전자기기에 내장된 하드웨어와 소프트웨어로 구현된다. 예를 들어, Wi-Fi 프로토콜을 사용하는 경우 무선 액세스 포인트(AP)과 무선 클라이언트 간에는 IEEE 802.11 규격에 따라 무선 신호가 주고받아지게 된다. 무선 클라이언트는 Wi-Fi 모듈을 통해 이러한 신호를 수신하고, 이를 소프트웨어적으로 해석하여 데이터를 처리한다.
    무선 통신의 경우 주파수 대역을 이용하여 데이터를 전송한다. Wi-Fi의 경우 2.4GHz 또는 5GHz 주파수 대역을 사용하며, 이를 이용해 무선 신호를 주고받는다. 무선 신호는 주파수 변조 방식으로 데이터를 전송하며, 이러한 신호는 전파의 강도와 주파수 변조의 형태에 따라 데이터가 전송된다.
    무선 통신에서는 주파수 대역을 공유하기 때문에 다른 무선 기기와의 간섭 문제가 발생할 수 있다. 이를 해결하기 위해서는 다양한 기술적인 방법이 사용된다. 예를 들어, Wi-Fi에서는 CSMA/CA(Carrier Sense Multiple Access with Collision Avoidance) 기술을 사용하여 다른 무선 기기와의 충돌을 최소화하고, Bluetooth에서는 주파수 점프 기술을 사용하여 다른 무선 기기와의 간섭을 최소화한다.

  - 근거리에 있는 여러 대의 전자기기가 서로 통신하는 프로토콜은 어떻게 동작할까요?
    근거리 통신에는 여러 가지 프로토콜이 사용될 수 있지만, 가장 대표적인 것은 Wi-Fi 프로토콜입니다. Wi-Fi는 IEEE 802.11 표준을 기반으로 하며, 이를 이용하여 무선으로 여러 대의 기기가 서로 통신할 수 있습니다.
    Wi-Fi 프로토콜은 기본적으로 무선 액세스 포인트(AP)과 클라이언트(스마트폰, 태블릿, 랩탑 등) 간의 통신을 지원합니다. 먼저 AP는 무선으로 클라이언트들에게 신호를 발송하고, 클라이언트는 이를 수신하여 데이터를 주고받습니다. 이 때 AP는 클라이언트의 식별 정보를 가지고 있으며, 이를 이용하여 클라이언트 간의 통신도 가능합니다.
    Wi-Fi 프로토콜은 여러 가지 보안 기능을 지원하며, 이를 이용하여 무선 네트워크의 보안성을 높일 수 있습니다. 예를 들어, WPA2는 Wi-Fi 프로토콜에서 사용되는 가장 보편적인 보안 프로토콜 중 하나이며, 데이터를 암호화하여 보호합니다.
    또한 Wi-Fi 프로토콜은 IEEE 802.11 표준이 계속해서 발전하고 있으며, 최신 기술인 Wi-Fi 6(IEEE 802.11ax)은 이전 표준에 비해 대역폭과 안정성 등 다양한 면에서 개선되었습니다.

  - 아주 멀리 떨어져 있는 두 전자기기가 유선/무선으로 서로 통신하는 프로토콜은 어떻게 동작할까요?
    아주 멀리 떨어져 있는 두 전자기기가 통신하는 경우에는 인터넷을 통한 중계가 필요하다. 일반적으로 이는 인터넷 서비스 제공자(ISP)라고 하는 중개 업체를 통해 이루어진다.
    두 전자기기 사이의 통신은 일반적으로 인터넷 프로토콜(IP)을 기반으로 한다. 데이터는 송신자 기기에서 ISP까지 유선 또는 무선으로 전송된다. ISP는 이 데이터를 다른 ISP로 전송하거나, 라우터로 이동시킨다. 라우터는 데이터 패킷을 수신하고, 패킷의 대상 IP 주소를 확인하여 다음 라우터나 목적지 기기로 전송한다.
    이러한 과정을 통해 두 전자기기 사이의 데이터 전송이 이루어진다. 이 때 데이터는 보안을 위해 암호화될 수 있다. 보안에 대한 기능은 인터넷 프로토콜 스위트의 일부인 보안 소켓 레이어(SSL)와 같은 보안 프로토콜을 사용하여 이루어진다.

  - 두 전자기기가 신뢰성을 가지고 통신할 수 있도록 하기 위한 프로토콜은 어떻게 동작할까요?
    두 전자기기가 신뢰성을 가지고 통신할 수 있도록 하는 프로토콜에는 TCP(Transmission Control Protocol)가 있다.
    TCP는 인터넷 상에서 데이터를 메시지의 형태로 보내기 위한 프로토콜로, IP(Internet Protocol)와 함께 인터넷의 핵심 프로토콜 중 하나이다. TCP는 IP가 전달한 데이터를 받아서 상위 계층인 애플리케이션 계층으로 전달하기 전에 데이터의 신뢰성을 보장하기 위해 여러 기능을 제공한다.
    TCP는 3-way 핸드셰이크 방식을 사용하여 연결을 설정하고, 데이터를 보내기 전에 상대방이 준비되어 있는지 확인한다. 이후 데이터를 보내면 수신 측에서는 데이터를 받았다는 ACK(acknowledgment) 메시지를 송신 측으로 전송하여 데이터의 정확성을 보장한다. 만약 ACK 메시지가 도착하지 않으면 송신 측에서는 데이터를 다시 전송하게 된다.
    데이터의 분실을 방지하기 위해 TCP는 흐름 제어(Flow Control)와 혼잡 제어(Congestion Control) 기능을 제공한다. 흐름 제어는 수신측의 버퍼 상태를 파악하여 데이터 전송 속도를 제어하고, 혼잡 제어는 네트워크 내의 데이터 혼잡 상태를 파악하여 데이터 전송 속도를 제어한다.
    이러한 기능들을 통해 TCP는 신뢰성이 높은 데이터 전송을 보장하며, 웹 브라우저와 웹 서버 간의 HTTP 통신 등 많은 프로토콜에서 사용되고 있다.

  - HTTP는 어떻게 동작할까요?
    HTTP가 작동하여 이용자에게 웹을 표시하는 과정은 다음과 같다.

    1. 사용자가 www.google.com 와 같은 URL을 웹 브라우저에 입력한다.
    2. DNS 조회를 통하여 www.naver.com 을 ip로 변환한다.
    3. TCP의 3way-handshaking 연결 방식으로 웹 서버에 연결하고 http는 80 https는 443포트이용한다.
    4. http 프로토콜을 이용하여 웹 서버에 요청(REQUSET)한다.
    5. 관련 기능에 따라 WAS와 상호 연동하며 필요한 경우 DB의 정보를 이용한다.
    6. 웹 서버는 최종 정보를 웹 브라우저에 응답(RESPONSE)하고 웹 브라우저는 전송 받은 내용을 표시한다.
    7. TCP의 4way-handshaking 연결 종료 방식으로 웹서버와 연결을 종료한다.

- 우리가 브라우저의 주소 창에 www.knowre.com 을 쳤을 때, 어떤 과정을 통해 서버의 IP 주소를 알게 될까요?
  브라우저의 주소창에 URL을 입력하고 Enter 키를 누르면, 다음과 같은 과정을 거쳐 해당 웹 페이지의 IP 주소를 알아내게 된다.

  1. 브라우저는 입력한 URL에서 도메인 네임(www.knowre.com)을 추출한다.
  2. 브라우저는 운영체제에 내장된 DNS(Domain Name System) 클라이언트에게 도메인 네임(www.knowre.com)에 해당하는 IP 주소를 요청한다.
  3. DNS 클라이언트는 도메인 네임(www.knowre.com)을 IP 주소로 변환하는 과정을 수행한다.
  4. DNS 서버에게 도메인 네임(www.knowre.com)에 해당하는 IP 주소를 요청한다.
  5. DNS 서버는 해당 도메인 네임(www.knowre.com)의 IP 주소를 포함하는 DNS 레코드를 반환한다.
  6. DNS 클라이언트는 반환된 IP 주소를 브라우저에게 전달한다.
  7. 브라우저는 해당 IP 주소를 이용하여 웹 서버에 HTTP 요청을 보낸다.
  8. 웹 서버는 요청된 리소스를 반환하고, 브라우저는 해당 리소스를 렌더링하여 화면에 표시한다.

  이러한 과정을 통해, 우리가 입력한 도메인 네임(www.knowre.com)을 해당 도메인 네임에 해당하는 IP 주소로 변환하여, 웹 서버와 통신할 수 있게 된다.

## Quest

- tracert(Windows가 아닌 경우 traceroute) 명령을 통해 www.google.com 까지 가는 경로를 찾아 보세요.
  - 어떤 IP주소들이 있나요?
    1 1 ms 1 ms 1 ms 192.168.0.1
    2 10 ms 8 ms 7 ms 123.140.224.1
    3 7 ms 9 ms 7 ms 10.8.12.105
    4 8 ms 11 ms 8 ms 10.9.6.105
    5 14 ms 15 ms 15 ms 183.111.5.14
    6 15 ms 16 ms 15 ms 183.111.3.193
    7 20 ms 19 ms 19 ms 72.14.212.201
    8 19 ms 19 ms 18 ms 108.170.245.97
    9 19 ms 18 ms 19 ms 209.85.255.116
    10 20 ms 19 ms 19 ms 74.125.253.69
    11 20 ms 19 ms 20 ms 142.251.49.109
    12 19 ms 20 ms 19 ms 216.239.42.109
    13 20 ms 19 ms 20 ms 74.125.252.92
    14 20 ms 19 ms 19 ms 108.170.244.209
    15 19 ms 20 ms \* 172.253.66.95
    16 20 ms 19 ms 20 ms 216.239.57.92
    17 19 ms 20 ms 19 ms 108.177.121.101
    18 19 ms 19 ms 20 ms 172.253.51.139
    19 19 ms 19 ms 19 ms 172.253.65.139
    20 19 ms 20 ms 19 ms 108.170.253.193
    21 20 ms 19 ms 19 ms 172.253.66.26
    22 20 ms 19 ms 19 ms 172.253.68.5
    23 20 ms 19 ms 20 ms 172.253.68.11
    24 19 ms 20 ms 20 ms 74.125.252.111
    25 20 ms 19 ms 20 ms 142.251.49.154
    26 19 ms 20 ms 19 ms 216.239.48.106
    27 19 ms 20 ms 19 ms 216.239.57.84
    28 19 ms 20 ms 19 ms 216.239.41.230
    이런식으로 매우 많다...... 중간에 ms는 호스트까지 걸린 시간을 의미한다.
  - 그 IP주소들은 어디에 위치해 있나요?
- Wireshark를 통해 www.google.com 으로 요청을 날렸을 떄 어떤 TCP 패킷이 오가는지 확인해 보세요
  - TCP 패킷을 주고받는 과정은 어떻게 되나요?
  - 각각의 패킷에 어떤 정보들이 담겨 있나요?
- telnet 명령을 통해 http://www.google.com/ URL에 HTTP 요청을 날려 보세요.
  - 어떤 헤더들이 있나요?
  - 그 헤더들은 어떤 역할을 하나요?

## Advanced

- HTTP의 최신 버전인 HTTP/3는 어떤 식으로 구성되어 있을까요?
- TCP/IP 외에 전세계적인 네트워크를 구성하기 위한 다른 방식도 제안된 바 있을까요?
