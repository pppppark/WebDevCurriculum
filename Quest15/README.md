# Quest 15. 자동화된 테스트

## Introduction

- 이번 퀘스트에서는 자동화된 테스트에 어떤 장점이 있는지, 어떤 식으로 구축할 수 있는지에 대해 알아보겠습니다.

## Topics

- Automated Test
  - TDD
  - Unit Test
  - Integration Test
  - E2E Test
  - Stub & Mock
- Jest
- Puppeteer

## Resources

- [Unit Test (단위 테스트) 도입하기](https://www.popit.kr/unit-test-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8F%84%EC%9E%85%ED%95%98%EA%B8%B0-1%ED%8E%B8/)
- [소프트웨어 테스트 안티 패턴](https://velog.io/@leejh3224/%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%95%88%ED%8B%B0-%ED%8C%A8%ED%84%B4)
- [End-to-End testing with Puppeteer and Jest](https://medium.com/touch4it/end-to-end-testing-with-puppeteer-and-jest-ec8198145321)
- [Mock & Stub](https://stackoverflow.com/questions/3459287/whats-the-difference-between-a-mock-stub)

## Checklist

- 자동화된 테스트를 만드는 것에는 어떤 장점과 단점이 있을까요?

  장점:

  - 시간과 비용을 절약할 수 있다. 수동으로 테스트하는 것보다 자동화된 테스트를 실행하는 것이 더 빠르고 정확하기 때문에 개발자들이 시간을 절약할 수 있다.
  - 테스트의 일관성과 신뢰성을 향상시킨다. 자동화된 테스트는 일관성 있는 방법으로 반복적으로 실행되며, 인간적인 실수를 제거하므로 테스트의 신뢰성을 높인다.
  - 버그를 빠르게 발견하고 수정할 수 있다. 자동화된 테스트는 코드 변경 후 바로 실행하여 버그를 발견하고 빠르게 수정할 수 있다.

  단점:

  - 초기 설정과 유지 보수가 필요하다. 자동화된 테스트를 만들기 위해 초기에 일정한 시간과 노력이 필요하며, 테스트 케이스가 변경될 때마다 유지 보수가 필요하다.
  - 모든 케이스를 커버하기 어려울 수 있다. 자동화된 테스트는 사람이 수동으로 실행하는 것과 다르게 모든 시나리오를 커버하지 못할 수 있다.
  - 일부 테스트 케이스는 자동화하기 어렵거나 불가능할 수 있다. 예를 들어, 그래픽 사용자 인터페이스(GUI)와 같이 시각적인 측면이나 사용자 경험과 관련된 부분은 자동화하기 어렵거나 불가능할 수 있다.

  * TDD(Test-Driven Development)란 무엇인가요? TDD의 장점과 단점은 무엇일까요?
    TDD(Test-Driven Development)는 소프트웨어 개발 방법론 중 하나로, 테스트 코드를 먼저 작성하고 그에 해당하는 코드를 작성하는 개발 방법을 말한다. TDD의 주요 장점은 다음과 같다.

    1. 더 나은 코드 품질: TDD를 적용하면 테스트를 통해 코드의 오류와 예외 상황을 미리 파악할 수 있으며, 이를 해결하여 코드의 품질을 높일 수 있다.
    2. 더 높은 코드 커버리지: 테스트 코드를 작성함으로써 테스트 커버리지를 높일 수 있다.
    3. 더 빠른 피드백: TDD는 빠른 피드백을 제공하여 개발자가 코드를 작성하면서 실시간으로 코드의 문제점을 파악하고 수정할 수 있도록 도와준다.
    4. 기능 추가와 유지보수가 쉬워짐: TDD는 새로운 기능 추가나 코드 변경 시에도 안정성을 보장하며 유지보수가 용이하도록 도와준다.

    단점

    1. 추가적인 시간과 비용이 소요될 수 있음: TDD는 테스트 코드를 작성하고, 코드를 작성하고, 리팩토링하는 과정을 거치기 때문에 초기 개발 시간이 길어지고 비용이 늘어날 수 있다.
    2. 복잡한 코드에 대한 테스트 케이스 작성이 어려움: 코드가 복잡하면 테스트 케이스를 작성하기 어려울 수 있다.
    3. 테스트 코드가 잘못 작성될 수 있음: 개발자가 테스트 코드를 작성하는 과정에서 실수를 할 수 있기 때문에, 테스트 코드 자체에 버그가 생길 수 있다.

    따라서, TDD는 장점과 단점이 모두 존재하며, 특정 프로젝트나 팀에 적합한 방법론인지 신중하게 판단해야한다.

- 테스트들 간의 계층에 따라 어떤 단계들이 있을까요?

  1. 단위 테스트(Unit Testing): 소프트웨어의 가장 작은 단위인 모듈, 함수, 클래스 등을 개별적으로 테스트하는 것이다. 이러한 테스트는 코드 변경이 있을 때 바로 검증할 수 있어 오류를 조기에 발견하고 수정할 수 있다.
  2. 통합 테스트(Integration Testing): 단위 테스트를 통과한 모듈들을 조합해 기능이 제대로 동작하는지 테스트하는 것이다. 이러한 테스트는 여러 모듈 간의 상호작용에서 발생할 수 있는 오류를 발견하는 데 도움이 된다.
  3. 시스템 테스트(System Testing): 통합 테스트를 통과한 시스템 전체를 테스트하는 것이다. 시스템이 요구사항을 충족하고 사용자에게 기대하는 기능을 수행하는지 확인한다.
  4. 인수 테스트(Acceptance Testing): 사용자 또는 고객이 시스템이 요구사항을 충족하는지 테스트하는 것이다. 이러한 테스트는 시스템이 실제로 사용되는 환경에서 기대하는 성능과 결과를 제공하는지 확인한다.

  이러한 테스트 단계들은 위에서부터 아래로 이어지는 계층적인 구조를 가지며, 각 단계에서 발견된 오류를 수정하고 다음 단계로 넘어간다. 이렇게 계층적인 구조를 가지는 것은 전체적인 품질을 높이고, 오류를 빨리 발견하고 수정할 수 있게 하며, 최종 사용자에게 높은 품질의 소프트웨어를 제공할 수 있도록 도와준다.

  - 유닛 테스트, 통합 테스트, E2E 테스트는 각각 어떤 것을 뜻하나요?
    유닛 테스트(Unit Test)는 소프트웨어의 최소 기능 단위인 모듈, 함수, 메서드 등의 개별 단위를 테스트하는 것이다. 이 테스트는 일반적으로 코드 변경 후 빠르게 수행되며, 모듈 간의 의존성을 최소화하여 다른 영향을 받지 않다.
    통합 테스트(Integration Test)는 각각의 모듈들을 통합하여 전체 시스템의 동작을 검증하는 것이다. 이러한 테스트는 시스템의 모든 부분을 대상으로 하므로 시스템의 의존성과 연관성을 고려하여 수행된다.
    E2E 테스트(End-to-End Test)는 사용자의 관점에서 전체 시스템이 예상대로 작동하는지 확인하는 테스트다. 이러한 테스트는 시스템의 외부 환경과의 상호 작용을 검증하므로 통합 테스트와 함께 수행된다. 보통 UI 테스트, 시스템 인터페이스 테스트 등을 포함한다.
    이러한 테스트는 테스트의 대상과 수행 방법에 따라 단위 테스트, 통합 테스트, 시스템 테스트 등으로 구분한다. 각각의 테스트는 시스템의 다른 부분에 대해 다른 검증을 수행하며, 결함을 이전에 발견하고 수정함으로써 소프트웨어의 품질을 향상시킨다.

  - 테스트에 있어서 Stub과 Mock은 어떤 개념을 가리키는 것일까요?
    테스트에서 Stub과 Mock은 서로 다른 개념을 가리키는데, 각각 다음과 같은 의미를 가지고 있다.

    - Stub: 실제 객체 대신에 특정한 값을 반환하도록 만든 가짜 객체다. 특정한 입력 값에 대해 미리 정해진 출력 값을 반환하므로, 특정 함수나 메소드의 동작을 테스트하는 경우 유용하다. 예를 들어, 파일 시스템의 특정 파일이 존재하는지 여부를 검사하는 함수를 테스트할 때, 실제 파일 시스템 대신에 파일이 존재하는 것처럼 동작하는 Stub을 사용할 수 있다.

    - Mock: 실제 객체와 비슷하지만, 객체 내부에서 어떤 메소드가 호출되었는지를 기록하고 검증할 수 있는 기능이 추가된 객체다. 특정 함수나 메소드의 호출 여부나 호출 횟수, 호출 시 전달된 인자 등을 검사하는 경우 유용하다. 예를 들어, 이메일 전송 기능을 테스트할 때, 실제 이메일을 전송하는 대신에 이메일이 전송되었는지 여부를 검사하는 Mock 객체를 사용할 수 있다.

    두 개념은 모두 테스트에서 사용되는 가짜 객체로, 특정 함수나 메소드를 호출할 때 이 객체를 호출하도록 설정한다. 그러나 Stub은 단순히 미리 정해진 값을 반환하는 반면, Mock은 호출 여부나 호출 횟수 등을 검증하는 기능을 추가로 제공한다.

- Jest는 어떤 일을 하며 어떻게 사용하는 테스트 프레임워크일까요?
  Jest는 Facebook에서 개발된 JavaScript 프로젝트를 위한 테스트 프레임워크다. Jest는 자동화된 테스트 실행, 코드 커버리지 리포팅 및 다양한 테스트 기능을 제공하며, 주로 유닛 테스트를 위해 사용된다. Jest는 다음과 같은 특징을 가지고 있다.

  - 기본적으로 zero-configuration 설정이 가능하다.
  - Snapshot 테스트 기능을 제공하여 UI 테스트에 특히 유용하다.
  - 테스트를 병렬로 실행하여 빠른 테스트를 보장한다.
  - 강력한 Mocking 기능을 제공한다.

  Jest를 사용하기 위해서는 다음과 같은 단계를 거친다.

  1. Jest를 프로젝트에 설치
  2. 테스트 파일을 작성합니다. Jest는 파일 이름이 `.test.js` 또는 `.spec.js`로 끝나는 파일을 자동으로 인식
  3. `npm test` 명령어를 실행하여 Jest를 실행
  4. Jest는 테스트를 실행하고 결과를 출력

  Jest는 유닛 테스트를 작성할 때 매우 유용한 도구
  또한 React와 같은 UI 라이브러리에서 Snapshot 테스트를 수행하는 것도 가능

  - Jest 이외의 테스트 프레임워크는 어떤 것이 있고 어떤 장단점이 있을까요?

    1. Mocha: Node.js와 브라우저에서 동작하는 JavaScript 테스트 프레임워크
       비동기 코드를 지원하며, 각각의 테스트는 it() 함수 안에서 작성
       장점: 다양한 언어와 프레임워크, 라이브러리 등에서 사용 가능
       비동기 테스트를 위한 대부분의 라이브러리들을 지원
       단점: 기본적으로는 assertion 라이브러리를 포함하지 않으므로, 별도로 설치하거나 assert 모듈을 사용해야 한다. 또한, 설정 및 사용 방법이 Jest보다 복잡함

    2. Jasmine: Node.js와 브라우저에서 동작하는 Behavior-Driven Development(BDD) 스타일의 JavaScript 테스트 프레임워크
       describe()와 it() 함수를 사용하여 테스트를 작성
       장점: 다양한 assertion 스타일을 지원함 테스트의 가독성이 높으며, 테스트 수트의 구조가 BDD 스타일에 맞게 작성되기 때문에 비즈니스 요구사항과 테스트 사이의 연결이 강해진다.
       단점: 자체적으로 mocking 기능을 제공하지 않는다. 따라서 별도의 라이브러리를 사용해야한다.

    3. Ava: Node.js에서 동작하는 간단하고 빠른 JavaScript 테스트 프레임워크다. 테스트 코드를 빠르게 실행하여 결과를 빠르게 볼 수 있다.
       장점: 실행 속도가 빠릅니다. 병렬로 실행하는 기능이 내장되어 있어, 여러 개의 테스트를 빠르게 수행할 수 있다.
       단점: 다른 프레임워크들에 비해 커버리지가 적다. mock이나 stub 기능이 제공되지 않는다.

    각 프레임워크마다 장단점이 있으며, 프로젝트의 요구사항에 맞게 선택해야한다. 또한, 프레임워크 외에도 assertion 라이브러리나 mocking 라이브러리를 결합하여 사용할 수 있다.

- Puppeteer는 어떤 일을 하며 어떻게 사용하는 테스트 프레임워크일까요?
  Puppeteer는 구글에서 개발한 Node.js 라이브러리로, 브라우저를 제어하여 웹 애플리케이션을 테스트하거나 웹 스크래핑 등 다양한 자동화 작업을 수행하는 도구다.
  Puppeteer는 브라우저 자동화를 위해 Chrome DevTools 프로토콜을 사용하며, 브라우저의 모든 기능에 접근할 수 있다. 따라서 테스트 시나리오를 자동으로 실행하거나 웹 페이지의 스크린샷을 찍는 등의 작업을 수행할 수 있다. 또한, 헤드리스 모드(Headless Mode)를 지원하므로 GUI 환경이 필요하지 않다.
  Puppeteer는 Jest와 함께 사용하여 E2E 테스트를 수행할 수 있다. Jest에서는 Puppeteer를 사용하여 브라우저를 자동으로 실행하고, 브라우저 상에서 테스트를 수행하며 결과를 확인한다. Puppeteer는 또한 Mocha나 Jasmine 등 다른 테스트 프레임워크와 함께 사용할 수도 있다.

  장점

  - Chrome DevTools 프로토콜을 사용하므로 브라우저의 모든 기능에 접근할 수 있다.
  - 헤드리스 모드를 지원하므로 GUI 환경이 필요하지 않다.
  - Jest와 같은 테스트 프레임워크와 함께 사용할 수 있다.

  단점으로는, 브라우저 자동화를 위해 Chrome을 사용하기 때문에 다른 브라우저에서는 사용할 수 없다는 점과, 브라우저 자동화가 성능에 영향을 미칠 수 있다는 점이 있다.

## Quest

- 직전 퀘스트의 메모장의 서버와 클라이언트 각 부분에 유닛 테스트, 통합 테스트, E2E 테스트 등을 추가해 보세요.
  - `npm test` 명령을 통해 모든 테스트가 돌고 그 결과를 출력할 수 있어야 합니다.

## Advanced

- 테스트의 커버리지는 어떤 개념일까요? 프로젝트에서 테스트의 커버리지는 어떻게 접근하는 것이 좋을까요?
