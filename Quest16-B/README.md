# Quest 16-B. 컨테이너

## Introduction

- 이번 퀘스트에서는 컨테이너 기술과 그 활용에 대해 알아보겠습니다.

## Topics

- 컨테이너 기술
- Docker
- docker-compose

## Resources

- [#LearnDocker](https://www.docker.com/101-tutorial)
- [Docker Tutorial for Beginners](https://docker-curriculum.com/)
- [docker-compose](https://docs.docker.com/compose/)

## Checklist

- 컨테이너는 어떻게 동작하나요? 다른 배포판을 사용할 수 있게 하는 원리가 무엇일까요?
  컨테이너는 가상화 기술을 이용하여 애플리케이션을 실행하는 방식이다. 컨테이너 안에는 필요한 실행 환경과 라이브러리 등이 포함되어 있어, 호스트 운영체제와는 분리된 실행 환경을 제공한다.
  컨테이너는 호스트 운영체제에서 실행 중인 가상 머신과는 달리, 호스트와 게스트 운영체제 간의 하드웨어 가상화를 하지 않고, 호스트 운영체제와 같은 커널을 공유하며 프로세스를 격리하여 실행한다. 이를 통해 가상 머신에 비해 빠른 속도와 적은 자원 사용량을 보장할 수 있다.
  컨테이너는 독립적으로 실행될 수 있으므로, 다양한 운영체제에서 애플리케이션을 실행할 수 있게 해준다. 이를 가능하게 하는 기술 중 하나가 컨테이너 오케스트레이션이다. 컨테이너 오케스트레이션은 여러 개의 컨테이너를 자동으로 배포, 관리, 스케일링할 수 있는 기능을 제공한다. 대표적인 컨테이너 오케스트레이션 기술로는 Kubernetes가 있다.

- 도커 컨테이너에 호스트의 파일시스템이나 네트워크 포트를 연결하려면 어떻게 해야 할까요?

  1. 호스트 파일시스템 연결
     을 사용해야 할 경우, `-v` 옵션을 사용하여 호스트와 컨테이너를 연결할 수 있다. 예를 들어, 호스트의 `/data` 디렉토리를 컨테이너의 `/mnt/data` 디렉토리로 연결하려면 다음과 같이 실행할 수 있다.

  docker run -v /data:/mnt/data (이미지 이름)

  이렇게 하면 컨테이너 내부에서 `/mnt/data` 경로에 접근하면 호스트의 `/data` 경로의 파일이나 디렉토리를 볼 수 있다.

  2. 호스트 네트워크 포트 연결

  도커 컨테이너에서 호스트의 네트워크 포트를 사용해야 할 경우, `-p` 옵션을 사용하여 호스트와 컨테이너를 연결할 수 있다. 예를 들어, 호스트의 `8080` 포트를 컨테이너의 `80` 포트로 연결하려면 다음과 같이 실행할 수 있다.

  docker run -p 8080:80 <이미지 이름>

  이렇게 하면 호스트에서 `http://localhost:8080`으로 접속하면 컨테이너 내부의 `http://localhost:80`으로 연결된다.

- 도커 컨테이너에서 런타임에 환경변수를 주입하려면 어떻게 해야 할까요?
  도커 컨테이너에서 런타임에 환경변수를 주입하기 위해서는 `docker run` 명령어나 `docker-compose` 파일에서 `--env` 또는 `-e` 옵션을 사용하여 환경변수를 지정할 수 있다. 예를 들어, `docker run` 명령어를 사용하여 `MY_ENV_VAR`라는 환경변수를 주입하려면 다음과 같이 입력한다.

  docker run -e MY_ENV_VAR=value my-image

  또는 `docker-compose` 파일에서 `environment` 키를 사용하여 환경변수를 지정할 수도 있다.

  version: "3"
  services:
  my-service:
  image: my-image
  environment:
  MY_ENV_VAR: value

  이렇게 하면 컨테이너가 시작될 때 환경변수가 주입되며, 컨테이너 내부에서 이를 사용할 수 있게 됩니다.

- 도커 컨테이너의 stdout 로그를 보려면 어떻게 해야 할까요?

  1. `docker logs` 명령어 사용하기
     `docker logs` 명령어를 사용하면 도커 컨테이너의 stdout 로그를 볼 수 있다. 이 명령어는 컨테이너 이름이나 ID를 지정하여 실행하며, `-f` 옵션을 사용하면 로그를 실시간으로 출력할 수 있다. 예를 들어, `my_container`라는 이름의 컨테이너의 로그를 출력하려면 다음과 같이 실행한다.

  docker logs my_container

  2. `docker exec` 명령어를 사용하기
     `docker exec` 명령어를 사용하면 도커 컨테이너 안에서 명령어를 실행할 수 있다. 이를 활용하여 컨테이너 안에서 직접 stdout 로그를 출력할 수 있다.
     예를 들어, `my_container`라는 이름의 컨테이너 안에서 `cat` 명령어를 실행하여 로그를 출력하려면 다음과 같이 실행한다.

  docker exec my_container cat /path/to/logfile

  위 예제에서 `/path/to/logfile`은 컨테이너 안에서 로그가 저장된 파일의 경로다.
  이 경로는 컨테이너 안에서 파일이 저장된 경로와 일치해야 한다.

- 실행중인 도커 컨테이너에 들어가 bash 등의 쉘을 실행하고 로그 등을 보려면 어떻게 해야 할까요?

  1. 실행 중인 컨테이너 ID를 확인한다.

  docker ps

  2. 확인한 컨테이너 ID로 컨테이너에 접속한다.

  docker exec -it [컨테이너 ID] bash

  3. 컨테이너 안에서 쉘을 실행하고 로그 등을 확인한다.

  ls
  cat [파일명]
  tail -f [로그 파일 경로]

  위와 같은 방법으로 컨테이너 안에서 쉘을 실행하고 로그 등을 확인할 수 있다.

## Quest

- 도커를 설치하고 그 사용법을 익혀 보세요.
- 메모장 시스템 서버를 컨테이너 기반으로 띄울 수 있게 수정해 보세요. (docker-compose는 사용하지 않습니다)
- 컨테이너를 Docker Hub에 올리고, 발급받은 학습용 AWS 계정에 EC2 인스턴스를 생성한 뒤, 해당 컨테이너를 띄워서 서비스 해 보세요.
- docker-compose를 사용하여, 이미지 빌드와 서버 업/다운을 쉽게 할 수 있도록 고쳐 보세요.

## Advanced

- 도커 외의 컨테이너 기술의 대안은 어떤 것이 있을까요?
- 맥이나 윈도우에서도 컨테이너 기술을 사용할 수 있는 원리는 무엇일까요?
